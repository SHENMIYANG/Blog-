<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<base href="/static/login/">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>登录</title>
<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/login.css">
<link rel="stylesheet" href="css/sign-up-login.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/inputEffect.css" />
<link rel="stylesheet" href="css/tooltips.css" />
<link rel="stylesheet" href="css/spop.min.css" />

<script src="js/jquery.js"></script>
<script src="js/snow.js"></script>
<script src="js/jquery.pure.tooltips.js"></script>
<script src="/static/layer/layer.js"></script>
<script src="/static/assets/js/core/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="js/spop.min.js"></script>
<script>	
	(function() {
		// trim polyfill : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim
		if (!String.prototype.trim) {
			(function() {
				// Make sure we trim BOM and NBSP
				var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
				String.prototype.trim = function() {
					return this.replace(rtrim, '');
				};
			})();
		}

		[].slice.call( document.querySelectorAll( 'input.input__field' ) ).forEach( function( inputEl ) {
			// in case the input is already filled..
			if( inputEl.value.trim() !== '' ) {
				classie.add( inputEl.parentNode, 'input--filled' );
			}

			// events:
			inputEl.addEventListener( 'focus', onInputFocus );
			inputEl.addEventListener( 'blur', onInputBlur );
		} );

		function onInputFocus( ev ) {
			classie.add( ev.target.parentNode, 'input--filled' );
		}

		function onInputBlur( ev ) {
			if( ev.target.value.trim() === '' ) {
				classie.remove( ev.target.parentNode, 'input--filled' );
			}
		}
	})();
	
	$(function() {	
		$('#login #login-password').focus(function() {
			$('.login-owl').addClass('password');
		}).blur(function() {
			$('.login-owl').removeClass('password');
		});
		$('#login #strpwd').focus(function() {
			$('.register-owl').addClass('password');
		}).blur(function() {
			$('.register-owl').removeClass('password');
		});
		$('#login #register-repassword').focus(function() {
			$('.register-owl').addClass('password');
		}).blur(function() {
			$('.register-owl').removeClass('password');
		});
		$('#login #forget-password').focus(function() {
			$('.forget-owl').addClass('password');
		}).blur(function() {
			$('.forget-owl').removeClass('password');
		});
	});
	
	function goto_register(){
		$("#strloginname").val("");
		$("#strpwd").val("");
		$("#register-repassword").val("");
		$("#stremail").val("");
		$("#tab-2").prop("checked",true);
	}
	
	function goto_login(){
		$("#strloginname").val("");
		$("#login-password").val("");
		$("#tab-1").prop("checked",true);
	}	
	function goto_forget(){
		$("#strloginname").val("");
		$("#forget-password").val("");
		$("#forget-code").val("");
		$("#tab-3").prop("checked",true);
	}

	
	
	
	
	
	
	
	
	
</script>
<style type="text/css">
html{width: 100%; height: 100%;}

body{

	background-repeat: no-repeat;

	background-position: center center #2D0F0F;

	background-color: #00BDDC;

	background-image: url(images/snow.jpg);

	background-size: 100% 100%;

}

.snow-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 100001; }

</style>
</head>
<body>
	<!-- 雪花背景 -->
	<div class="snow-container"></div>
	<!-- 登录控件 -->
	<div id="login">
		<input id="tab-1" type="radio" name="tab" class="sign-in hidden" checked />
		<input id="tab-2" type="radio" name="tab" class="sign-up hidden" />
		<input id="tab-3" type="radio" name="tab" class="sign-out hidden" />
		<div class="wrapper">
			<!-- 登录页面 -->
			<div class="login sign-in-htm">
				<form class="container offset1 loginform">
					<!-- 猫头鹰控件 -->
					<div id="owl-login" class="login-owl">
						<div class="hand"></div>
						<div class="hand hand-r"></div>
						<div class="arms">
							<div class="arm"></div>
							<div class="arm arm-r"></div>
						</div>
					</div>
					<div class="pad input-container">
						<section class="content">
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text" id="login-name" 
									autocomplete="off" placeholder="请输入账号" tabindex="1" maxlength="30" />
								<label class="input__label input__label--hideo" for="login-name">
									<i class="fa fa-fw fa-user icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="login-name"></span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="password" id="login-pwd" placeholder="请输入密码" tabindex="2" maxlength="30"/>
								<label class="input__label input__label--hideo" for="login-password">
									<i class="fa fa-fw fa-lock icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="login-pwd"></span>
						</section>
					</div>
					<div class="form-actions">
						<a tabindex="4" class="btn pull-left btn-link text-muted" onClick="goto_forget()">忘记密码?</a>
						<a tabindex="5" class="btn btn-link text-muted" onClick="goto_register()">注册</a>
						<input class="btn btn-primary" type="button" tabindex="3" onClick="go()" value="登录" 
							style="color:white;"/>
					</div>
				</form>
			</div>
			<!-- 忘记密码页面 -->
			<div class="login sign-out-htm">
				<form action="#" method="post" class="container offset1 loginform">
					<!-- 猫头鹰控件 -->
					<div id="owl-login" class="forget-owl">
						<div class="hand"></div>
						<div class="hand hand-r"></div>
						<div class="arms">
							<div class="arm"></div>
							<div class="arm arm-r"></div>
						</div>
					</div>
					<div class="pad input-container">
						<section class="content">
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text"  id="forget-name" autocomplete="off" placeholder="请输入账号"/>
								<label class="input__label input__label--hideo" for="forget-name">
									<i class="fa fa-fw fa-user icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text" id="forget-email" autocomplete="off" placeholder="请输入邮箱"/>
								<label class="input__label input__label--hideo" for="forget-email">
									<i class="fa fa-fw fa-wifi icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
					
				
						<input class="btn btn-primary" type="button" onClick="sendemail()" value="点击发送邮件获取验证码" 
							style="color:white;"/>
							
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text" id="forget-code" placeholder="请输入验证码" />
								<label class="input__label input__label--hideo" for="forget-code">
									<i class="fa fa-fw fa-lock icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>

							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="password" id="forget-password" placeholder="请重置密码" />
								<label class="input__label input__label--hideo" for="forget-password">
									<i class="fa fa-fw fa-lock icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
						</section>
					</div>
					<div class="form-actions">
						<a class="btn pull-left btn-link text-muted" onClick="goto_login()">返回登录</a>
						<input class="btn btn-primary" type="button" onClick="forget()" value="重置密码" 
							style="color:white;"/>
					</div>
				</form>
			</div>
			<!-- 注册页面 -->
			<div class="login sign-up-htm">
				<form action="#" method="post" class="container offset1 loginform">
					<!-- 猫头鹰控件 -->
					<div id="owl-login" class="register-owl">
						<div class="hand"></div>
						<div class="hand hand-r"></div>
						<div class="arms">
							<div class="arm"></div>
							<div class="arm arm-r"></div>
						</div>
					</div>
					<div class="pad input-container">
						<section class="content">
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text"  id="stremail" autocomplete="off" placeholder="请输入合法邮箱如：***@163.com"/>

								<label class="input__label input__label--hideo" for="stremail">
									<i class="fa fa-fw fa-wifi icon icon--hideo"></i>

									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="email">请填写正确的邮件，以用来激活您的账号</span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text" id="strtel" 
									autocomplete="off" placeholder="请输入合法手机号" maxlength="15"/>
								<label class="input__label input__label--hideo" for="strtel">
									<i class="fa fa-fw fa-user icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="tel"></span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text" id="strloginname" 
									autocomplete="off" placeholder="*请输入用户名" maxlength="15"/>
								<label class="input__label input__label--hideo" for="strloginname">
									<i class="fa fa-fw fa-user icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="loginname"></span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="text" id="strlookname" 
									autocomplete="off" placeholder="*请输入昵称" maxlength="15"/>
								<label class="input__label input__label--hideo" for="strlookname">
									<i class="fa fa-fw fa-user icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="lookname"></span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="password" id="strpwd" placeholder="*请输入密码" maxlength="15"/>
								<label class="input__label input__label--hideo" for="strpwd">
									<i class="fa fa-fw fa-lock icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="pwd"></span>
							<span class="input input--hideo">
								<input class="input__field input__field--hideo" type="password" id="strrepwd" placeholder="*请确认密码" maxlength="15"/>
								<label class="input__label input__label--hideo" for="restrpwd">
									<i class="fa fa-fw fa-lock icon icon--hideo"></i>
									<span class="input__label-content input__label-content--hideo"></span>
								</label>
							</span>
							<span class="repwd"></span>
						</section>
					</div>
					<div class="form-actions">
						<a class="btn pull-left btn-link text-muted" onClick="goto_login()">返回登录</a>
						<input class="btn btn-primary" type="button" onClick="register()" value="注册" 
							style="color:white;"/>
					</div>
				</form>
			</div>
		</div>
	</div>
	<div style="text-align:center;">
</div>
</body>
</html>
<script src="js/jquery.js"></script>
<script>
	//登录
	var login = false;
	var loginpwds = false; 
	$('#login-name').bind('blur',function()
	{
		var logingo = $(this).val();
		if(logingo == "")
		{
			$('.login-name').html('账号不能为空');
			login = false;
			return ;
		}else
		{	
			$('.login-name').html('');
			login = true;
		}
	})
	$('#login-pwd').bind('blur',function()
	{
		var loginpwd = $(this).val();
		if(loginpwd == "")
		{
			$('.login-pwd').html('密码不能为空');
			loginpwds = false;
			return ;
		}else
		{	
			$('.login-pwd').html('');
			loginpwds = true;
		}
	})

	function go()
	{
		if(login && loginpwds)
		{

			var logingo = $('#login-name').val();
			var loginpwd = $('#login-pwd').val();

			$.post('/login_do',{strloginname:logingo,strpwd:loginpwd},function(msg)
			{
			
				if(msg.code == '1001')
				{
					layer.msg(msg.msg, {icon: 6,time: 2000,shade: [0.5,'#333333']},function(index){
						location.href='/about';
						layer.close(index);
					})
				}else if(msg.code == '1004'){
					layer.alert(msg.msg, {
					    skin: 'layui-layer-lan'
					    ,closeBtn: 0
					    ,anim: 5 //动画类型
					  });
				}else if(msg.code == '1005'){
					layer.alert(msg.msg, {
					    skin: 'layui-layer-molv'
					    ,closeBtn: 0
					    ,anim: 4 //动画类型
					  });
				}else{
					layer.msg(msg.msg, {icon: 5});
				}
			})

		}else{
			return false;
		}
	}





	//注册
	var email = false;
	var tel = false;
	var loginname = false;
	var lookname = false;
	var pwd = false;
	var repwd = false;

	
	$('#stremail').bind('blur',function()
	{

		var stremail = $(this).val();
		if(stremail == "")
		{
			$('.email').html('邮箱不能为空');
			email = false;
			return ;
		}else
		{
			var stremail_flag = /^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/;
			if(stremail_flag.test(stremail))
			{
				$('.email').html("");
				email = true;
			}else
			{
				$('.email').html('请输入正确格式的邮箱');				
				email = false;
				return ;
			}
		}
	})
	$('#strtel').bind('blur',function()
	{
		var strtel = $(this).val();
		if(strtel == "")
		{
			$('.tel').html('手机号不能为空');
			tel = false;
			return ;
		}else
		{
			var strtel_flag = /^1(3|4|5|7|8)\d{9}$/;

			if(strtel_flag.test(strtel))
			{
				$('.tel').html('');
				tel = true;
			}else
			{
				$('.tel').html('请输入合理的手机号');
				tel = false;
				return ;
			}
		}
	})
	$('#strloginname').bind('blur',function()
	{
		var strloginname = $(this).val();
		if(strloginname == "")
		{
			$('.loginname').html('账号不能为空');
			loginname = false;
			return ;
		}else
		{
			var strloginname_flag = /^[A-Za-z0-9]{3,30}$/;

			if(strloginname_flag.test(strloginname))
			{
				$('.loginname').html('');
				loginname = true;
			}else
			{
				$('.loginname').html('账号必须英文、数字但不包括下划线等符号的3-30位');
				loginname = false;
				return ;
			}
		}
	})
	
	$('#strlookname').bind('blur',function()
	{
		var strlookname = $(this).val();
		if(strlookname == "")
		{
			$('.lookname').html('昵称不能为空');
			lookname = false;
			return ;
		}else
		{
			var strlookname_flag = /^[\u4E00-\u9FA5A-Za-z0-9!,@,#,$,%,^,&,*,(,),_,+,-,~]{3,30}$/;

			if(strlookname_flag.test(strlookname))
			{
				$('.lookname').html('');
				lookname = true;
			}else
			{
				$('.lookname').html('昵称必须3-30位');
				lookname = false;
				return ;
			}
		}
	})
	$('#strpwd').bind('blur',function()
	{
		var strpwd = $(this).val();
		if(strpwd == "")
		{
			$('.pwd').html('密码不能为空');
		
			pwd = false;
			return ;
		}else
		{
			var  strpwd_flag = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,30}$/;

			if(strpwd_flag.test(strpwd))
			{
				$('.pwd').html('');
				pwd = true;

			}else
			{
				$('.pwd').html('密码必须包含大小写字母和数字的组合，不能使用特殊字符，长度在6-30之间');
				pwd = false;
				return ;
			}
		}
	})
	$('#strrepwd').bind('blur',function()
	{
		var strrepwd = $(this).val();
		var strpwd = $('#strpwd').val();
		if(strpwd == "")
		{
			$('.repwd').html('请再次输入密码');
			pwd = false;
			return ;
		}else
		{
			if(strpwd == strrepwd)
			{
				$('.repwd').html('');
				repwd = true;
			}else
			{
				$('.repwd').html('两次输入密码不一致');
				repwd = false;
				return ;
			}
		}
	})
	function register()
	{
		if(email && tel && loginname && lookname && pwd && repwd)
		{

			var stremail = $('#stremail').val();
			var strtel = $('#strtel').val();
			var strloginname = $('#strloginname').val();
			var strlookname = $('#strlookname').val();
			var strpwd = $('#strpwd').val();
		
			$.post("/register",{stremail:stremail,strtel:strtel,strloginname:strloginname,strlookname:strlookname,strpwd:strpwd},function(json)
            {
            	console.log(json);
              if(json.code == '1000')
              {
              	layer.msg(json.msg, {icon: 6,time: 2000,shade: [0.5,'#333333']},function(index){
				location.href='/fr_login';

				layer.close(index);

				});
              }else 
              {
              	layer.msg(json.msg, {icon:5,time:1000});
              }
            }, 'json')			
		}else
		{		
			return false;
		}
	}
	

	//重置密码
	
	var yonghu = false;
	var youxiang = false;
	var yanzhengma = false;
	var chongzhi = false;
	$('#forget-name').bind('blur',function()
	{
		var forge_name =  $(this).val();
		if(forge_name == "")
		{
			layer.tips('账号不能为空', '#forget-name',{tips: [2, '#0FA6D8'],tipsMore: true,time:4000});
			yonghu = false;
			return ;
		}else{
			yonghu = true;
			
		}
					
	})
	$('#forget-email').bind('blur',function()
	{
		var forge_email =  $(this).val();
		if(forge_email == "")
		{
			layer.tips('邮箱不能为空', '#forget-email',{tips: [2, '#0FA6D8'],tipsMore: true,time:4000});
			youxiang = false;
			return ;
		}else{
			youxiang = true;;
			
		}
	})
	
	
	function sendemail()
	{

		if(yonghu && youxiang)
		{
			var forge_email =  $('#forget-email').val();
			var forge_name =  $('#forget-name').val();
			$.post('/forget',{forge_email:forge_email,forge_name:forge_name},function(msg)
			{
				if(msg.code == "1000")
				{	
					layer.alert(msg.msg, {icon: 6});
				}else{
					layer.alert(msg.msg, {icon: 5});
				}
			})
			 
		}else{
			layer.msg('请输入合理的账号和邮箱');
			return false;
		}
	}
	$('#forget-code').bind('blur',function()
	{
		var forget_code =  $(this).val();

		if(forget_code == "")
		{
			layer.tips('验证码不能为空', '#forget-code',{tips: [2, '#0FA6D8'],tipsMore: true,time:4000});
			yanzhengma = false;
			return ;
		}else{
			yanzhengma = true;;
			
		}
	})
	$('#forget-password').bind('blur',function()
	{
		
		var forget_password =  $(this).val();

		if(forget_password == "")
		{
			layer.tips('重置密码不能为空', '#forget-password',{tips: [2, '#0FA6D8'],tipsMore: true,time:4000});
			chongzhi = false;
			return ;
		}else{
			var  forget_password_flag = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,30}$/;

			if(forget_password_flag.test(forget_password))
			{
				chongzhi = true;

			}else
			{
				layer.tips('密码必须包含大小写字母和数字的组合，不能使用特殊字符，长度在6-30之间', '#forget-password',{tips: [2, '#0FA6D8'],tipsMore: true,time:4000});
				chongzhi = false;
				return ;
			}
			
		}
	})
	function forget()
	{
		alert(1);
		console.log(yonghu,youxiang,yanzhengma,chongzhi);
		

		if(yonghu && youxiang && yanzhengma && chongzhi)
		{
		
			var forge_email =  $('#forget-email').val();
			var forge_name =  $('#forget-name').val();
			var forge_code =  $('#forget-code').val();
			var forge_password =  $('#forget-password').val();
				
			console.log(forge_email,forge_name,forge_code,forge_password);

			$.post('/forupd',{forge_email:forge_email,forge_name:forge_name,forge_code:forge_code,forge_password:forge_password},function(msg)
			{
				if(msg.code == '2000')
				{
					layer.msg(msg.msg, {icon: 6,time: 2000,shade: [0.5,'#333333']},function(index){
						location.href='/fr_login';

						layer.close(index);

					});
				}else if(msg.code == '2004')
				{
					layer.alert(msg.msg, {
					    skin: 'layui-layer-lan'
					    ,closeBtn: 0
					    ,anim: 5 //动画类型
					  });
				}else{
					layer.alert(msg.msg, {icon: 5});
				}
			},'json')
		}else{
			return false;
		}
	}
	
		
</script>